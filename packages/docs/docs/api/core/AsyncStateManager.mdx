---
sidebar_position: 3
---

import { ApiLink } from '@site/src/components/api-link'
import { InheritedFrom } from '@site/src/components/inherited-from'
import { LabeledItem } from '@site/src/components/labeled-item'
import { MarkdownWrapper } from '@site/src/components/markdown-wrapper'
import { ObjectShapeDefinition } from '@site/src/components/object-shape-definition'
import {
  DoesNotReturnAnything,
  DoesNotTakeAnyParameters,
  Returns,
} from '@site/src/components/sentence-templates'
import { DataType, TypeDisplay } from '@site/src/components/type-display'
import { DocConstants } from '@site/src/constants'
import CodeInline from '@theme/CodeInline'

# AsyncStateManager

## Overview

<TypeDisplay>{DataType.class}</TypeDisplay>

<MarkdownWrapper>{DocConstants.TSDOC_DESC_ASYNC_STATE_MANAGER}</MarkdownWrapper>

```ts
class AsyncStateManager<State> extends StateManager<State> { }
```

### Constructor

```ts
constructor(defaultState: State, options: StateManagerOptions)
```

#### Parameters
<ObjectShapeDefinition
  data={[
    {
      name: 'defaultState',
      type: DataType.any,
      description: DocConstants.COMMON_DESC_DEFAULT_STATE,
    },
    {
      name: 'options',
      type: DataType.StateManagerOptions,
      defaultValue: '`{}`',
      description: DocConstants.TSDOC_PARAM_DESC_STATE_MANAGER_OPTIONS_GENERAL,
    },
  ]}
/>

#### Example
```js
import { AsyncStateManager } from '{:CORE_PACKAGE_NAME:}'

const ExampleState = new AsyncStateManager('...')
```

## Properties

### defaultState

<InheritedFrom
  href={'./StateManager#defaultState'}
  name={'StateManager.defaultState'}
/>

<MarkdownWrapper>{DocConstants.COMMON_DESC_DEFAULT_STATE}</MarkdownWrapper>

```ts
readonly defaultState: State
```

### name

<InheritedFrom
  href={'./StateManager#name'}
  name={'StateManager.name'}
/>

<MarkdownWrapper>{DocConstants.TSDOC_DESC_OPTIONS_NAME}</MarkdownWrapper>

```ts
readonly name: string
```

### isInitializing

<InheritedFrom
  href={'./StateManager#isInitializing'}
  name={'StateManager.isInitializing'}
/>

<MarkdownWrapper>{DocConstants.TSDOC_DESC_IS_INITIALIZING}</MarkdownWrapper>

```ts
readonly isInitializing: SimpleStateManager<boolean>
```

## Methods

### init

<InheritedFrom
  href={'./StateManager#init'}
  name={'StateManager.init'}
/>

<MarkdownWrapper>{DocConstants.TSDOC_METHOD_DESC_INIT}</MarkdownWrapper>
<p>
  <LabeledItem label='Also see'>
    <ApiLink href='./StateManagerInitArgs'>StateManagerInitArgs</ApiLink>
  </LabeledItem>
</p>

```ts
init(initFn: (args: StateManagerInitArgs<State>) => void | Promise<void>): Promise<void>
```

#### Parameters

<ObjectShapeDefinition
  data={[
    {
      name: 'initFn',
      type: DataType.Function,
      description: DocConstants.TSDOC_PARAM_DESC_INIT_FN,
    },
  ]}
/>

#### Returns
<Returns name='init'>{DocConstants.RETURN_DESC_INIT}</Returns>

#### Example
```js
await ExampleState.init(({ commit }) => {
  const someValue = localStorage.get('some-value')
  commit(someValue)
})
```

### get

<InheritedFrom
  href={'./StateManager#get'}
  name={'StateManager.get'}
/>

<MarkdownWrapper>{DocConstants.TSDOC_METHOD_DESC_GET_ASYNC}</MarkdownWrapper>

```ts
get(): Promise<State>
```

#### Parameters
<DoesNotTakeAnyParameters name='get' />

#### Returns
<Returns name='get'>{DocConstants.RETURN_DESC_GET_ASYNC}</Returns>

#### Example
```js
const state = await ExampleState.get()
```

### getSync

<MarkdownWrapper>{DocConstants.TSDOC_METHOD_DESC_GET_SYNC}</MarkdownWrapper>

```ts
getSync(): State
```

#### Parameters
<DoesNotTakeAnyParameters name='getSync' />

#### Returns
<Returns name='getSync'>{DocConstants.RETURN_DESC_GET}</Returns>

#### Example
```js
const state = ExampleState.getSync()
```

### set

<InheritedFrom
  href={'./StateManager#set'}
  name={'StateManager.set'}
/>

<MarkdownWrapper>{DocConstants.TSDOC_METHOD_DESC_SET_BY_VALUE}</MarkdownWrapper>

```ts
set(newState: State): Promise<void>
```
<MarkdownWrapper>{DocConstants.TSDOC_METHOD_DESC_SET_BY_FUNCTION}</MarkdownWrapper>
```ts
set(setStateFn: AsyncSetStateFn<State>): Promise<void>
```

#### Parameters
`set` takes either one of the following parameters:
<ObjectShapeDefinition
  requireEitherOne
  data={[
    {
      name: 'newState',
      type: DataType.any,
      description: DocConstants.TSDOC_PARAM_DESC_SET_NEW_STATE,
    },
    {
      name: 'setStateFn',
      type: DataType.SetStateFn,
      description: DocConstants.TSDOC_PARAM_DESC_SET_FUNCTION,
    },
  ]}
/>

#### Returns
<Returns name='set'>{DocConstants.RETURN_DESC_SET_ASYNC}</Returns>

#### Example
```js
// Assuming that state is of type `number`
await ExampleState.set(42)
await ExampleState.set((previousState) => previousState + 1)
```

### reset

<InheritedFrom
  href={'./StateManager#reset'}
  name={'StateManager.reset'}
/>

<MarkdownWrapper>{DocConstants.TSDOC_METHOD_DESC_RESET}</MarkdownWrapper>

```ts
reset(): Promise<void>
```

#### Parameters
<DoesNotTakeAnyParameters name='reset' />

#### Returns
<Returns name='set'>{DocConstants.RETURN_DESC_RESET_ASYNC}</Returns>

#### Example
```js
await ExampleState.reset()
```

### watch

<InheritedFrom
  href={'./StateManager#watch'}
  name={'StateManager.watch'}
/>

<MarkdownWrapper>{DocConstants.TSDOC_METHOD_DESC_WATCH}</MarkdownWrapper>

```ts
watch(callback: (state: State, eventType: StateChangeEventType) => void): () => void
```

#### Parameters
<ObjectShapeDefinition
  data={[{
    name: 'callback',
    type: DataType.Function,
    description: DocConstants.TSDOC_PARAM_DESC_WATCH_CALLBACK,
  }]}
/>

#### Returns
<Returns name='watch'>{DocConstants.RETURN_DESC_WATCH}</Returns>

#### Example
```js
const unwatch = ExampleState.watch((state) => { console.log(state) })
// ··· then after some time ···
unwatch()
```

### unwatchAll

<InheritedFrom
  href={'./StateManager#unwatchAll'}
  name={'StateManager.unwatchAll'}
/>

<MarkdownWrapper>{DocConstants.TSDOC_METHOD_DESC_UNWATCH_ALL}</MarkdownWrapper>

```ts
unwatchAll(): void
```

#### Parameters
<DoesNotTakeAnyParameters name='unwatchAll' />

#### Returns
<Returns name='unwatchAll'>{DocConstants.RETURN_DESC_UNWATCH_ALL}</Returns>

#### Example
```js
ExampleState.unwatchAll()
```

### wait

<InheritedFrom
  href={'./StateManager#wait'}
  name={'StateManager.wait'}
/>

<MarkdownWrapper>{DocConstants.TSDOC_METHOD_DESC_WAIT_BY_VALUE}</MarkdownWrapper>

```ts
wait(expectedValue: State): Promise<State>
```
<MarkdownWrapper>{DocConstants.TSDOC_METHOD_DESC_WAIT_BY_EVALUATOR}</MarkdownWrapper>
```ts
wait(evaluator: WaitEvaluator<State>): Promise<State>
```

#### Parameters
`wait` takes either one of the following parameters:
<ObjectShapeDefinition
  requireEitherOne
  data={[
    {
      name: 'expectedValue',
      type: DataType.any,
      description: DocConstants.TSDOC_PARAM_DESC_WAIT_EXPECTED_VALUE,
    },
    {
      name: 'evaluator',
      type: DataType.WaitEvaluator,
      description: DocConstants.TSDOC_PARAM_DESC_WAIT_EVALUATOR,
    },
  ]}
/>

#### Returns
<Returns name='wait'>{DocConstants.RETURN_DESC_WAIT}</Returns>

#### Example
```js
// Promise will resolve when the state value becomes `42`.
await ExampleState.wait(42)

// Promise will resolve when the function returns `true`.
await ExampleState.wait((state) => fulfillsSomeCondition(state))
```

### dispose

<InheritedFrom
  href={'./StateManager#dispose'}
  name={'StateManager.dispose'}
/>

<MarkdownWrapper>{DocConstants.TSDOC_METHOD_DESC_DISPOSE}</MarkdownWrapper>

```ts
dispose(): Promise<void>
```

#### Parameters
<DoesNotTakeAnyParameters name='dispose' />

#### Returns
<Returns name='dispose'>{DocConstants.RETURN_DESC_DISPOSE_ASYNC}</Returns>

#### Example
```js
await ExampleState.dispose()
```
